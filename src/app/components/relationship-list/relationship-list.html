<div class="details-section primary-section relationship-list-section">
  <label class="primary-label">Relationships</label>
  
  <!-- Filter buttons -->
  <div class="relationship-filters">
    <div class="filter-group">
      <label class="filter-label">Show:</label>
      <button type="button" class="filter-btn" [class.active]="relationshipFilter === 'all'" (click)="setRelationshipFilter('all')">All</button>
      <button type="button" class="filter-btn" [class.active]="relationshipFilter === 'with-relationship'" (click)="setRelationshipFilter('with-relationship')">With Relationship</button>
      <button type="button" class="filter-btn" [class.active]="relationshipFilter === 'without-relationship'" (click)="setRelationshipFilter('without-relationship')">Without Relationship</button>
    </div>
    
    <div class="filter-group">
      <label class="filter-label">Story:</label>
      <select class="story-filter-select" [value]="storyFilter" (change)="onStoryFilterChange($event)">
        <option value="all">All Stories</option>
        @for (story of availableStories; track story) {
          <option [value]="story">{{ story }}</option>
        }
      </select>
    </div>
  </div>
  
  <div class="details-section relationship-section relationship-grid-container">
    @for(character of filteredCharacterList; track character) {
      <div class="relationship relationship-grid-item" id="relationship-{{character.id}}">
        <div class="relationship-header">
          <input type="checkbox" id="relationship-checkbox-{{character.id}}" [value]="character.id" (change)="toggleRelationship($event, character.id)" [checked]="getRelationship(character.id)?.hasRelationship"/>
          <button class="linked-character" [routerLink]="['/character', character.id]">
            <label for="relationship-textarea-{{character.id}}" class="secondary-label">{{ character.firstName }} {{ character.lastName }}</label>
          </button>
        </div>
        @if(character.altNames && character.altNames.length > 0) {           
          <p class="alt-names">( {{ character.altNames.join(', ') }} )</p>
        }
        @if (getRelationship(character.id)?.hasRelationship) {
          <input type="text" id="relationship-type-{{character.id}}" placeholder="Relationship Type" [value]="getRelationship(character.id)?.relationshipType?.join(', ')"/>
          <textarea id="relationship-description-{{character.id}}" placeholder="Describe relationship...">{{ getRelationship(character.id)?.relationshipDescription }}</textarea>
        } @else {
          <input type="text" class="relationship-type-input hidden" id="relationship-type-{{character.id}}" placeholder="Relationship Type" [value]="getRelationship(character.id)?.relationshipType?.join(', ')"/>
          <textarea class="hidden" id="relationship-description-{{character.id}}" placeholder="Describe relationship...">{{ getRelationship(character.id)?.relationshipDescription }}</textarea>
        }
      </div>
    }
  </div>
</div>